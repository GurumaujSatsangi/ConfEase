<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEI CMT</title>
    <link rel="shortcut icon" href="/dei_logo.png" type="image/x-icon">
    <link rel="stylesheet" href="/styles.css" />
</head>
<body>
    <%- include('../partials/dashboard/header') %>
    <div class="container">
      <h4>Welcome <%= user.name %> (<%= user.email %>)!</h4><hr>
      <h6>You have been invited as a speaker for the following conferences:</h6>
      
      <% if (message) { %>
        <div class="alert alert-primary alert-dismissible fade show" role="alert">
          <%= message %>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      <% } %>

      <% if (conference && conference.conference_id) { %>
      <table class="table">
        <tr>
            <td><b>Conference Title</b></td>
            <td><b>Deadline for Full Paper Submission</b></td>
            <td><b>Action</b></td>
        </tr>
        
        <tr>
            <td><%= conference.title %></td>
            <td><%= conference.full_paper_submission %> (11:59 PM IST)</td>
            <td><a class="btn btn-outline-primary" href="/submission/invited-talk/<%= conference.conference_id %>">Submit</a></td>
        </tr>
      </table>
      <% } else { %>
        <h6><i class="bi bi-emoji-frown-fill"></i> &nbsp;No conference details available.</h6>
      <% } %>

      <hr />
      <h4>My Submitted Talks</h4>
      <% if (submissions && submissions.length > 0) { %>
        <% submissions.forEach(function(submission) { %>
          <div class="card mb-3">
            <div class="card-header">
              <strong><%= submission.title %></strong>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-bordered table-sm">
                  <tr>
                    <th style="max-width: 200px;">Abstract</th>
                    <th style="min-width: 120px;">Track</th>
                    <th style="width: 100px; text-align: center;">View File</th>
                    <th style="width: 100px; text-align: center;">Action</th>
                  </tr>
                  <tr>
                    <td style="max-width: 200px; word-wrap: break-word; overflow-wrap: break-word;">
                      <div style="max-height: 60px; overflow-y: auto;">
                        <%= submission.abstract || 'N/A' %>
                      </div>
                    </td>
                    <td><%= submission.track_name || 'N/A' %></td>
                    <td style="text-align: center;">
                      <% if (submission.file_url) { %>
                        <a href="<%= submission.file_url %>" target="_blank" class="btn btn-sm btn-outline-info">
                          <i class="bi bi-eye-fill"></i>
                        </a>
                      <% } else { %>
                        <span class="text-muted">-</span>
                      <% } %>
                    </td>
                    <td style="text-align: center;">
                      <a href="/submission/delete/invitee/<%= submission.paper_id %>" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this submission?');">
                        <i class="bi bi-trash3-fill"></i>
                      </a>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        <% }); %>
      <% } else { %>
        <h6><i class="bi bi-emoji-frown-fill"></i> &nbsp;You have not submitted any talks yet.</h6>
      <% } %>
      <hr>
    </div>

    <script src="/script.js"></script>
    <%- include('../partials/footer') %>
</body>
</html>